<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Inventory</title>
    <link rel="stylesheet" href="{{ url_for('serve_root_styles') }}">
</head>
<body>
    <header class="site-header">
        <div class="header-container">
            <a href="{{ url_for('home') }}" class="logo">
                <svg class="logo-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                    <path fill="currentColor" d="M7 4h-2a1 1 0 0 0 0 2h1.22l1.6 6.4a2 2 0 0 0 1.95 1.45h7.48a1 1 0 0 0 .97-.76l1.2-5.2a1 1 0 0 0-.97-1.24H8.7L8.2 4.2A1 1 0 0 0 7 4zm0 14a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3zm10 0a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3z"/>
                </svg>
                <span class="logo-text">GrocerEase</span>
            </a>
            <nav class="nav-buttons">
                <a href="{{ url_for('staff') }}" class="nav-btn nav-btn--secondary">Dashboard</a>
                <a href="{{ url_for('inventory') }}" class="nav-btn nav-btn--primary">Inventory</a>
                <a href="{{ url_for('home') }}" class="nav-btn nav-btn--secondary">Logout</a>
            </nav>
        </div>
    </header>

    <main>
        <section class="page-hero">
            <div class="hero-content">
                <div class="hero-copy">
                    <h1>Inventory Overview</h1>
                    <p class="lead">Live counts and quick actions â€” restock alerts highlight low stock automatically.</p>
                </div>
                <div class="hero-illustration" aria-hidden="true">
                    <svg viewBox="0 0 140 90" xmlns="http://www.w3.org/2000/svg" role="img"></svg>
                </div>
            </div>
        </section>

        <div class="inventory-header">
            <div class="inventory-title">
                <h1>Inventory</h1>
                <p>Inventory of the business.</p>
            </div>

            <div class="inventory-actions">
                <a class="btn btn--info" href="/download_inventory_pdf">Download Pdf</a>
            </div>
        </div>

        <section>
            <h2>Current Inventory</h2>
            
            <!-- Display inventory per location -->
            {% for loc_id in locations_inventory|sort %}
                {% set loc_data = locations_inventory[loc_id] %}
                <section style="margin-top: 2rem; padding: 1rem; border: 1px solid #ddd; border-radius: 4px;">
                    <h2 style="color: #1f2937;">{{ loc_data['location_name'] }}</h2>
                    <div class="inventory-table">
                        <table style="width:100%; border-collapse: collapse; margin-top: 20px;">
                            <thead>
                                <tr style="background-color: #f3f4f6;">
                                    <th style="padding: 12px; text-align: left; border: 1px solid #000000;">Product ID</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #000000;">Product Name</th>
                                    <th style="padding: 12px; text-align: left; border: 1px solid #000000;">Category</th>
                                    <th style="padding: 12px; text-align: right; border: 1px solid #000000;">Quantity</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for product in loc_data['products'] %}
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #000000;">{{ product['product_id'] }}</td>
                                    <td style="padding: 12px; border: 1px solid #000000;">{{ product['product_name'] }}</td>
                                    <td style="padding: 12px; border: 1px solid #000000;">{{ product['category_name'] }}</td>
                                    <td style="padding: 12px; text-align: right; border: 1px solid #000000; {% if product['quantity'] < 10 %}background-color: #ffa500;{% endif %}">{{ product['quantity'] }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </section>
            {% endfor %}

            <!-- Display totals across all locations -->
            <section style="margin-top: 2rem; padding: 1rem; border: 2px solid #059669; border-radius: 4px; background-color: #f0fdf4;">
                <h2 style="color: #059669;">Total Inventory (All Locations)</h2>
                <div class="inventory-table">
                    <table style="width:100%; border-collapse: collapse; margin-top: 20px;">
                        <thead>
                            <tr style="background-color: #d1fae5;">
                                <th style="padding: 12px; text-align: left; border: 1px solid #059669;">Product ID</th>
                                <th style="padding: 12px; text-align: left; border: 1px solid #059669;">Product Name</th>
                                <th style="padding: 12px; text-align: left; border: 1px solid #059669;">Category</th>
                                <th style="padding: 12px; text-align: right; border: 1px solid #059669;">Total Quantity</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% if totals %}
                                {% for product in totals %}
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #059669;">{{ product[0] }}</td>
                                    <td style="padding: 12px; border: 1px solid #059669;">{{ product[1] }}</td>
                                    <td style="padding: 12px; border: 1px solid #059669;">{{ product[2] }}</td>
                                    <td style="padding: 12px; text-align: right; border: 1px solid #059669; {% if product[3] < 10 %}background-color: #ffa500;{% endif %}">{{ product[3] }}</td>
                                </tr>
                                {% endfor %}
                            {% else %}
                                <tr>
                                    <td colspan="4" style="padding: 12px; text-align: center; border: 1px solid #059669;">No products found in inventory</td>
                                </tr>
                            {% endif %}
                        </tbody>
                    </table>
                </div>
            </section>
        </section>
        
        <section>
            <p><a class="btn btn--inventory" href="{{ url_for('staff') }}">Back to Staff</a></p>
        </section>
    </main>

    <div class="back-to-home">
        <a class="btn btn--danger" href="{{ url_for('home') }}">Back to Home</a>
    </div>

    <footer>
        <div class="footer-content">
            <p class="copyright">&copy; 2025 GrocerEase</p>
            <div class="footer-links">
                <a href="privacy-policy.html">Privacy Policy</a>
                <a href="terms-of-service.html">Terms of Service</a>
                <a href="contact.html">Contact Us</a>
            </div>
        </div>
    </footer>
</body>
</html>
